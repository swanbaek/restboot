<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.multicamp.mapper.PostMapper">
 
 	<insert id="createPost" parameterType="Post">
	 	<selectKey keyProperty="id" resultType="_int" order="BEFORE">
	 		select react_post_seq.nextval from dual
	 	</selectKey>
	 	<!-- insert문 완성 -->
	 	insert into react_post
	 	values(#{id},#{name},#{content},#{filename:VARCHAR},SYSDATE)	 	
	</insert>
	<select id="getPostCount" resultType="_int">
		select count(id) from react_post
	</select>
	<select id="listPosts" resultType="Post" parameterType="Page">
		select * from(
		select p.*, row_number() over(order by id desc) rn from react_post p
		)
		<where>
			<![CDATA[
			rn > #{start} and rn < #{end}
			]]>
		</where>
	</select>
	
	<update id="updatePost" parameterType="Post">
		update react_post set name=#{name}, content=#{content}, wdate=sysdate
		<if test="filename!=null and filename!=''">
		, filename=#{filename}
		</if>
		<where>
			id=#{id}
		</where>	
	</update>
	<delete id="deletePost" parameterType="_int">
		delete from react_post where id=#{value}
	</delete>
</mapper>
